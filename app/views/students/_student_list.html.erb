<style type="text/css">
  span.slow {
    padding: 2px;
    background-color: coral;
    color: white;
    border-radius: 6px;
    margin-left: 3px;
  }
  span.unlocked {
    padding: 2px;
    background-color: red;
    color: white;
    border-radius: 6px;
    margin-left: 3px;
  }
  span.trained {
    padding: 2px;
    background-color: red;
    color: white;
    border-radius: 6px;
    margin-left: 3px;
  }
  span.unlocked.done, span.trained.done {
    background-color: green;
  }
</style>
<div class="ui segment student-source">
  <table class="ui teal sortable celled table">
    <thead>
      <tr>
        <th class="one wide center sorted ascending">姓名</th>
        <th class="one wide center aligned">性别</th>
        <th class="two wide center aligned">联系电话</th>
        <th class="two wide center aligned">状态</th>
        <th class="two wide center aligned">进度</th>
        <th class="two wide center aligned">报名日期</th>
        <th class="three wide center aligned">教练</th>
        <th class="three wide center aligned">操作</th>
      </tr>
    </thead>
    <tbody>
      <% @students.each do |st| %>
      <tr class="<%= st.intention.current_status %>">
        <% if st.id_card.present? %>
        <td class="middle aligned"><%= st.name %></td>
        <% else %>
        <td class="middle aligned" style="color: red;"><%= st.name %></td>
        <% end %>
        <td class="middle center aligned"><%= st.gender %><% if st.is_slow? %><span class="slow">慢</span><% end %></td>
        <td class="middle center aligned" <%= st.is_local_phone? ? '' : 'style=color:red;' %>>
          <%= st.phone_divided.html_safe %>
        </td>
        <td class="middle center aligned"><%= st.intention.current_status_text %><span class="unlocked<%= st.is_unlocked? ? ' done' : '' %>">锁</span><span class="trained<%= st.is_trained? ? ' done' : '' %>">消</span><span class="trained<%= st.swift_number.present? ? ' done' : '' %>">流</span>
        </td>
        <td class="middle center aligned"><%= st.process_text %></td>
        <td class="middle center aligned">
          <% if st.signed_at.present? %>
          <%= "#{st.signed_at.to_date.to_s(:db)}" %>
          <% else %>
          暂无
          <% end %>
        </td>
        <td class="middle aligned">
          <% if st.coach.present? %>
          <%= "#{st.coach.name}[#{st.coach.phone}]" %>
          <% else %>
          暂无
          <% end %>
        </td>
        <td class="middle aligned">
          <%= link_to '意向', intention_path(st.intention), { class: 'small-button', target: '_blank' } %>
          <%= link_to '资料', student_path(st), { class: 'small-button', target: '_blank' } %>
          <%= link_to '编辑', edit_student_path(st), { class: 'small-button', target: '_blank' } %>
          <% if st.qq.present? %>
          <span style="color:green;" title="<%= st.qq %>">QQ</span>
          <% else %>
          <span style="color:red;">QQ</span>
          <% end %>
        </td>
      </tr>
      <% end %>
    </tbody>
  </table>
</div>

<script type="text/javascript">
  $('table').tablesort();
</script>
